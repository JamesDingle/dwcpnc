//
// Created by jad on 26/02/18.
//

#ifndef DWCPNC_PROFILE_H
#define DWCPNC_PROFILE_H


enum season {
    WINTER = 1,
    SPRING = 2,
    SUMMER = 3,
    AUTUMN = 4
};

static double sigma_winter[83] = {19.47, 21.06, 61.38, 56.3, 28.43, 56.3, 24.27, 20.48, 11.95, 20.64, 32.48, 54.3, 6.3,
                                  26.77, 25.83, 22.78, 41.21, 25.92, 19.12, 26.77, 25.83, 25.91, 22.78, 32.48, 21.3,
                                  24.6, 20.8, 37.6, 38.5, 22.6, 22.6, 29.4, 32.4, 50.3, 29.3, 65.8, 50.3, 83.7, 43,
                                  38.2, 34.6, 28, 38.6, 31.2, 23.7, 13.7, 26.2, 17.5, 25.9, 17, 24.1, 28, 43, 35.01, 38,
                                  41.7, 33.4};
static double sigma_spring[83] = {22.37, 19.29, 34.93, 20.05, 40.64, 70.47, 21.07, 27.89, 11.95, 20.64, 32.48, 29.53,
                                  6.3, 31.83, 24.32, 14.62, 31.24, 39.45, 13.38, 31.83, 24.32, 21.8, 14.62, 32.48, 23.8,
                                  21.7, 20.2, 37.6, 22.2, 25.2, 25.2, 30, 21.6, 37, 17.2, 29, 37, 37.1, 43, 38.8, 25.5,
                                  29.7, 34.6, 37.4, 27.9, 13.5, 18.7, 13.8, 21.8, 19.8, 32.9, 28, 43, 35.1, 61.8, 41.7,
                                  33.4};
static double sigma_summer[83] = {15.24, 17.4, 20.72, 15.96, 28.43, 23.22, 10.2, 26.19, 22.95, 16.05, 24.87, 16.9,
                                  19.31, 31.48, 16.64, 14.62, 32.35, 18.38, 9.77, 31.48, 16.64, 32.37, 14.62, 24.87,
                                  28.8, 37.3, 32.6, 37.6, 38.6, 27, 27, 30.3, 14.4, 36.2, 29, 21, 36.2, 27.5, 59.7,
                                  52.8, 29, 27.6, 44.2, 27.9, 32, 11, 16.1, 19.4, 32.4, 8.7, 29.8, 28, 59.7, 35.1, 69.6,
                                  41.7, 22.6};
static double sigma_autumn[83] = {19.47, 21.06, 39.44, 39.46, 16.22, 22.01, 12.82, 23.16, 16.97, 16.05, 29.3, 23.12,
                                  13.63, 31.14, 12.27, 22.78, 26.77, 25.92, 9.68, 31.14, 12.27, 27.06, 22.78, 29.3,
                                  25.8, 26.4, 21.5, 37.6, 21.5, 19.9, 19.9, 34.9, 22.3, 37.3, 38.7, 30.6, 37.3, 33.1,
                                  23.6, 37.6, 29.9, 29.7, 41.2, 28.1, 25.6, 13.8, 17.9, 21.2, 27.1, 26.2, 27, 28, 23.6,
                                  35.1, 37.4, 41.7, 22.6};

static double zm_winter[83] = {-3.96, 32.39, 33.71, 74.7, 44.8, 74.7, 51.75, 61.08, 52.97, 97.82, 32.24, -26.98, 49.47,
                               79.83, 33.48, 48.81, 84.68, 83.99, 0.66, 79.83, 33.48, 28.9, 50, 32.24, 86, 100.9, 81.3,
                               47.7, 40.1, 45.5, 45.5, 91.2, 26.6, 30.7, 16.8, 25.5, 30.7, 48.3, 39.2, 83.1, 90.8, 57.1,
                               36, 76.7, 74.5, 12.7, 23.4, 28.2, 28.9, 29.1, 47.4, 44.7, 39.2, 48.2, 36.9, 46.4, 36.4};
static double zm_spring[83] = {18.9, 18.29, 20.4, 14.15, 49.38, 82.73, 70.98, 60.43, 52.97, 97.82, 32.24, 8.52, 49.47,
                               6.17, 17.62, 49.44, 83.37, 41.2, 3.98, 6.17, 17.62, 22.57, 50, 32.24, 70.8, 85.9, 73.1,
                               47.7, 68.6, 56.2, 56.2, 60, 13.6, 30.3, 24.2, 28.5, 30.3, 57, 22.1, 72.4, 102, 47.5,
                               46.1, 70.2, 63.9, 13.1, 28.5, 21.7, 22.6, 22.1, 50, 44.7, 22.1, 48.2, 18.4, 46.4, 36.4};
static double zm_summer[83] = {18.18, 23.71, 19.01, 19.35, 44.8, 87.17, 46.37, 52.04, 31.36, 92.42, 3.42, 31.76, 24.88,
                               17.66, 29.23, 49.44, 64.48, 67.07, 4.25, 17.66, 29.23, 22.04, 50, 3.42, 51.7, 70.5, 57.1,
                               47.7, 24.2, 30.8, 30.8, 57.3, 18, 25.4, 19.4, 45, 25.4, 81.1, 48.9, 84.3, 99.2, 52.4,
                               42.9, 76.9, 54.6, 8.6, 31.9, 45.5, 22, 40.2, 34.8, 44.7, 48.9, 48.2, 46.6, 46.4, 34.6};
static double zm_autumn[83] = {-3.96, 32.39, 9.89, 27.69, 40.22, 86.4, 44.76, 63.44, 44.43, 92.42, 11.12, 19.07, 29.5,
                               29.16, 23.41, 48.81, 69.89, 83.99, 0.66, 29.16, 23.41, 19.87, 50, 11.12, 64.9, 85.9,
                               89.5, 47.7, 31.4, 34.7, 34.7, 64.7, 32.1, 18.9, 12.9, 29.8, 18.9, 66.1, 56.3, 93.8, 71.6,
                               44.5, 45.01, 82.4, 94.4, 12.4, 33, 34.7, 19.9, 16.6, 41.1, 44.7, 56.3, 48.2, 37.6, 46.4,
                               34.6};

static double rho_winter[83] = {0.79, 0.84, 0.55, 0.78, 0.89, 0.78, 0.8, 0.84, 0.82, 0.75, 0.69, 0.74, 0.87, 0.77, 0.55,
                                0.78, 0.84, 0.84, 0.53, 0.767, 0.548, 0.863, 0.78, 0.69, 0.812, 0.793, 0.835, 0.838,
                                0.872, 0.897, 0.897, 0.721, 0.545, 0.805, 0.642, 0.898, 0.805, 0.982, 0.914, 0.79,
                                0.862, 0.835, 0.93, 0.881, 0.866, 0.694, 0.937, 0.87, 0.863, 0.348, 0.912, 0.845, 0.914,
                                0.802, 0.786, 0.893, 0.872};
static double rho_spring[83] = {0.86, 0.85, 0.8, 0.88, 0.92, 0.85, 0.84, 0.94, 0.82, 0.75, 0.69, 0.82, 0.87, 0.74, 0.81,
                                0.87, 0.86, 0.8, 0.56, 0.739, 0.81, 0.883, 0.87, 0.69, 0.857, 0.755, 0.821, 0.838,
                                0.852, 0.89, 0.89, 0.761, 0.806, 0.85, 0.963, 0.909, 0.85, 0.93, 0.914, 0.79, 0.817,
                                0.833, 0.878, 0.823, 0.838, 0.581, 0.909, 0.803, 0.883, 0.843, 0.787, 0.845, 0.914,
                                0.802, 0.855, 0.893, 0.872};
static double rho_summer[83] = {0.83, 0.87, 0.86, 0.85, 0.89, 0.89, 0.87, 0.88, 0.86, 0.7, 0.76, 0.88, 0.96, 0.75, 0.84,
                                0.87, 0.89, 0.87, 0.64, 0.748, 0.837, 0.92, 0.87, 0.76, 0.795, 0.763, 0.951, 0.838,
                                0.914, 0.868, 0.868, 0.791, 0.883, 0.841, 0.898, 0.905, 0.841, 0.895, 0.868, 0.825,
                                0.841, 0.899, 0.936, 0.872, 0.915, 0.723, 0.901, 0.921, 0.92, 0.75, 0.942, 0.845, 0.868,
                                0.802, 0.865, 0.893, 0.972};
static double rho_autumn[83] = {0.79, 0.84, 0.91, 0.97, 0.86, 0.8, 0.83, 0.9, 0.75, 0.7, 0.69, 0.93, 0.85, 0.76, 0.87,
                                0.78, 0.88, 0.84, 0.58, 0.756, 0.866, 0.91, 0.78, 0.69, 0.876, 0.756, 0.848, 0.838,
                                0.893, 0.904, 0.904, 0.781, 0.917, 0.834, 0.934, 0.937, 0.834, 0.919, 0.728, 0.79,
                                0.856, 0.922, 0.904, 0.848, 0.798, 0.807, 0.906, 0.937, 0.91, 0.83, 0.927, 0.845, 0.728,
                                0.802, 0.655, 0.893, 0.972};

typedef struct {
    int count;
    double *winter_vals;
    double *spring_vals;
    double *summer_vals;
    double *autumn_vals;
} prof_params;

typedef struct {
    int count;
    double step;
    double zmin;
    double zmax;
    double *depths;
    double *values;
} depth_profile_t;

typedef struct {
    double sunrise;
    int count;
    double *values;
} time_profile_t;

typedef struct {
    double start;
    double step;
    int count;
    double *values;
} wavelength_array_t;

depth_profile_t *
gen_chl_prof(
        double zmin,
        double zmax,
        int count,
        double step,
        int province,
        double surface_chl
);

time_profile_t *
gen_time_prof(
        double sunrise,
        int count
);

wavelength_array_t *
gen_wavelength_array(
        double start,
        double step,
        int count
);

prof_params *init_sigma();

prof_params *init_zm();

prof_params *init_rho();

double lookup_sigma(int season, int province);

double lookup_zm(int season, int province);

double lookup_rho(int season, int province);

double B0_from_surface_chl(double chl, double rho, double zm, double sigma);

double compute_h(double sigma, double rho, double B0);

#endif //DWCPNC_PROFILE_H
